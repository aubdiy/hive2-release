PREHOOK: query: EXPLAIN
CREATE TABLE x AS
  SELECT key, 1 as tag FROM src WHERE key = '238'
  UNION ALL
  SELECT key, tag FROM src1
  LATERAL VIEW EXPLODE(array(2)) tf as tag
  WHERE key = '238'
PREHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: query: EXPLAIN
CREATE TABLE x AS
  SELECT key, 1 as tag FROM src WHERE key = '238'
  UNION ALL
  SELECT key, tag FROM src1
  LATERAL VIEW EXPLODE(array(2)) tf as tag
  WHERE key = '238'
POSTHOOK: type: CREATETABLE_AS_SELECT
Plan not optimized by CBO.

Vertex dependency in root stage
Map 1 <- Union 2 (CONTAINS)
Map 3 <- Union 2 (CONTAINS)

Stage-3
  Stats-Aggr Operator
    Stage-9
      Create Table Operator:
        name:default.x
        Stage-2
          Dependency Collection{}
            Stage-5(CONDITIONAL)
              Move Operator
                Stage-8(CONDITIONAL CHILD TASKS: Stage-5, Stage-4, Stage-6)
                  Conditional Operator
                    Stage-1
                      Union 2
                      <-Map 1 [CONTAINS]
                        File Output Operator [FS_13]
                          table:{"name:":"default.x"}
                          Select Operator [SEL_12] (rows=274 width=10)
                            Output:["_col0","_col1"]
                            Select Operator [SEL_2] (rows=250 width=10)
                              Output:["_col1"]
                              Filter Operator [FIL_14] (rows=250 width=10)
                                predicate:(key = '238')
                                TableScan [TS_0] (rows=500 width=10)
                                  Output:["key"]
                      <-Map 3 [CONTAINS]
                        File Output Operator [FS_13]
                          table:{"name:":"default.x"}
                          Select Operator [SEL_12] (rows=274 width=10)
                            Output:["_col0","_col1"]
                            Select Operator [SEL_10] (rows=24 width=7)
                              Output:["_col1"]
                              Lateral View Join Operator [LVJ_8] (rows=24 width=7)
                                Output:["_col5"]
                                Select Operator [SEL_5] (rows=12 width=7)
                                  Lateral View Forward [LVF_4] (rows=12 width=7)
                                    Filter Operator [FIL_15] (rows=12 width=7)
                                      predicate:(key = '238')
                                      TableScan [TS_3] (rows=25 width=7)
                                        Output:["key"]
                        File Output Operator [FS_13]
                          table:{"name:":"default.x"}
                          Select Operator [SEL_12] (rows=274 width=10)
                            Output:["_col0","_col1"]
                            Select Operator [SEL_10] (rows=24 width=7)
                              Output:["_col1"]
                              Lateral View Join Operator [LVJ_8] (rows=24 width=7)
                                Output:["_col5"]
                                UDTF Operator [UDTF_7] (rows=12 width=7)
                                  function name:explode
                                  Select Operator [SEL_6] (rows=12 width=7)
                                    Output:["_col0"]
                                     Please refer to the previous Lateral View Forward [LVF_4]
            Stage-4(CONDITIONAL)
              File Merge
                 Please refer to the previous Stage-8(CONDITIONAL CHILD TASKS: Stage-5, Stage-4, Stage-6)
            Stage-7
              Move Operator
                Stage-6(CONDITIONAL)
                  File Merge
                     Please refer to the previous Stage-8(CONDITIONAL CHILD TASKS: Stage-5, Stage-4, Stage-6)
        Stage-0
          Move Operator
             Please refer to the previous Stage-5(CONDITIONAL)
             Please refer to the previous Stage-4(CONDITIONAL)
             Please refer to the previous Stage-7

PREHOOK: query: CREATE TABLE x AS
  SELECT key, 1 as tag FROM src WHERE key = '238'
  UNION ALL
  SELECT key, tag FROM src1
  LATERAL VIEW EXPLODE(array(2)) tf as tag
  WHERE key = '238'
PREHOOK: type: CREATETABLE_AS_SELECT
PREHOOK: Input: default@src
PREHOOK: Input: default@src1
PREHOOK: Output: database:default
PREHOOK: Output: default@x
POSTHOOK: query: CREATE TABLE x AS
  SELECT key, 1 as tag FROM src WHERE key = '238'
  UNION ALL
  SELECT key, tag FROM src1
  LATERAL VIEW EXPLODE(array(2)) tf as tag
  WHERE key = '238'
POSTHOOK: type: CREATETABLE_AS_SELECT
POSTHOOK: Input: default@src
POSTHOOK: Input: default@src1
POSTHOOK: Output: database:default
POSTHOOK: Output: default@x
POSTHOOK: Lineage: x.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src1)src1.FieldSchema(name:key, type:string, comment:default), ]
POSTHOOK: Lineage: x.tag EXPRESSION []
PREHOOK: query: SELECT * FROM x
PREHOOK: type: QUERY
PREHOOK: Input: default@x
#### A masked pattern was here ####
POSTHOOK: query: SELECT * FROM x
POSTHOOK: type: QUERY
POSTHOOK: Input: default@x
#### A masked pattern was here ####
238	1
238	1
238	2
